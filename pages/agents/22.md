---
layout: default
---

# Ejemplo: DetecciÃ³n de PII

<div class="text-xs mt-4">

```typescript
import { createAgent, createMiddleware, HumanMessage } from "langchain";

const piiMiddleware = createMiddleware({
  name: "PIIMiddleware",
  beforeModel: (state) => {
    const lastMsg = state.messages[state.messages.length - 1];
    const emailRegex = /\b[\w.+-]+@[\w.-]+\.[a-z]{2,}\b/gi;
    if (emailRegex.test(lastMsg.content)) {
      // Enmascarar emails antes de enviar al LLM
      const masked = lastMsg.content.replace(emailRegex, "[EMAIL]");
      return { messages: [...state.messages.slice(0, -1), new HumanMessage(masked)] };
    }
    return;
  },
});

const agent = createAgent({ model: "gpt-4o-mini", middleware: [piiMiddleware] });
```

<v-click>

<div class="mt-3 text-xs opacity-80">
ğŸ’¡ En producciÃ³n usa librerÃ­as especializadas como Microsoft Presidio
</div>

</v-click>

</div>
